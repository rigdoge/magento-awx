# 代码审查规范

## 1. YAML 文件格式规范

### 1.1 基本格式要求
- 使用 2 个空格进行缩进，不使用 Tab
- 文件开头必须包含 `---` 标记
- 文件末尾保留一个空行
- 列表项使用 `-` 标记，后跟一个空格

### 1.2 文件命名规范
- 使用小写字母和连字符（-）
- 文件名应清晰表明其用途
- 包含版本号时使用点号（.）分隔

## 2. Kubernetes 资源配置最佳实践

### 2.1 元数据配置
- 必须为所有资源指定适当的 namespace
- 使用有意义的 name 和 labels
- 建议使用 annotations 记录配置的额外信息

### 2.2 容器配置
- 总是指定具体的镜像版本标签，避免使用 latest
- 配置适当的资源请求和限制
- 设置健康检查（readiness 和 liveness 探针）
- 使用非 root 用户运行容器

### 2.3 配置管理
- 使用 ConfigMap 存储配置文件
- 敏感信息使用 Secrets 存储
- 避免在配置文件中硬编码环境特定的值

## 3. 变量命名规范

### 3.1 Ansible 变量
- 使用小写字母和下划线
- 变量名应具有描述性
- 避免使用保留字和特殊字符

### 3.2 环境变量
- 使用大写字母和下划线
- 添加适当的前缀以标识用途

## 4. 注释规范

### 4.1 必要的注释内容
- 文件顶部说明文件用途
- 复杂任务的执行逻辑说明
- 特殊配置的原因说明
- 依赖关系说明

### 4.2 注释格式
- 使用清晰简洁的语言
- 保持注释与代码的同步更新
- 避免无用或显而易见的注释

## 5. 安全配置检查清单

### 5.1 访问控制
- 使用最小权限原则
- 正确配置 RBAC 规则
- 避免使用默认 ServiceAccount

### 5.2 网络安全
- 配置适当的网络策略
- 使用 TLS 加密通信
- 限制端口暴露范围

### 5.3 容器安全
- 使用最小化基础镜像
- 配置适当的安全上下文
- 定期更新基础镜像

## 6. 代码审查流程

### 6.1 提交前检查
- 确保代码符合以上规范
- 测试配置的有效性
- 检查是否包含敏感信息

### 6.2 审查重点
- 配置的正确性和完整性
- 安全性考虑
- 可维护性和可扩展性
- 文档完整性

### 6.3 审查反馈
- 提供具体的修改建议
- 重点关注潜在的问题和风险
- 确保修改符合项目标准